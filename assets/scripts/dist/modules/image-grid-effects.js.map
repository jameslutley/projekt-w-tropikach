{"version":3,"sources":["../../src/modules/image-grid-effects.js"],"names":["imageGridEffects","throttle","fn","delay","allowSample","e","setTimeout","nextSibling","el","nodeType","extend","a","b","key","hasOwnProperty","support","transitions","Modernizr","csstransitions","transEndEventName","WebkitTransition","MozTransition","OTransition","msTransition","transition","prefixed","onEndTransition","callback","onEndCallbackFn","ev","target","removeEventListener","call","addEventListener","GridFx","constructor","options","gridEl","items","slice","querySelectorAll","previewEl","isExpanded","isAnimating","closeCtrl","querySelector","previewDescriptionEl","_init","onInit","self","window","imagesLoaded","classList","add","_initEvents","_setOriginal","_setClone","clickEvent","ontouchstart","forEach","item","touchend","preventDefault","_openItem","touchmove","manageTouch","_closeItem","onResize","gridImg","gridImgOffset","getBoundingClientRect","current","indexOf","getAttribute","onOpenItem","src","width","offsetWidth","height","offsetHeight","left","top","win","_getWinSize","originalSizeArr","split","originalSize","dx","imgPosition","x","Math","abs","dy","y","z","min","pagemargin","cloneImg","style","WebkitTransform","transform","descriptionEl","innerHTML","onExpand","originalImg","opacity","document","createElement","className","maxWidth","parseInt","maxHeight","appendChild","setAttribute","settings","gridItem","remove","onCloseItem","documentElement","clientWidth","innerHeight","prototype"],"mappings":"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","file":"image-grid-effects.js","sourcesContent":["/* globals window Modernizr imagesloaded */\n\n/**\n * main.js\n * http://www.codrops.com\n *\n * Licensed under the MIT license.\n * http://www.opensource.org/licenses/mit-license.php\n *\n * Copyright 2015, Codrops\n * http://www.codrops.com\n */\n\nexport default function imageGridEffects() {\n  const support = {\n    transitions: Modernizr.csstransitions,\n  };\n\n  // transition end event name\n  const transEndEventNames = {\n    WebkitTransition: 'webkitTransitionEnd',\n    MozTransition: 'transitionend',\n    OTransition: 'oTransitionEnd',\n    msTransition: 'MSTransitionEnd',\n    transition: 'transitionend',\n  };\n\n  const transEndEventName = transEndEventNames[Modernizr.prefixed('transition')];\n\n  const onEndTransition = (el, callback) => {\n    const onEndCallbackFn = (ev) => {\n      if (support.transitions) {\n        if (ev.target !== this) return;\n        this.removeEventListener(transEndEventName, onEndCallbackFn);\n      }\n      if (callback && typeof callback === 'function') {\n        callback.call(this);\n      }\n    };\n    if (support.transitions) {\n      el.addEventListener(transEndEventName, onEndCallbackFn);\n    } else {\n      onEndCallbackFn();\n    }\n  };\n\n  /**\n   * some helper functions\n   */\n\n  function throttle(fn, delay) {\n    let allowSample = true;\n\n    return (e) => {\n      if (allowSample) {\n        allowSample = false;\n        setTimeout(() => {\n          allowSample = true;\n        }, delay);\n        fn(e);\n      }\n    };\n  }\n\n  function nextSibling(el) {\n    let nextSibling = el.nextSibling;\n    while (nextSibling && nextSibling.nodeType !== 1) {\n      nextSibling = nextSibling.nextSibling\n    }\n    return nextSibling;\n  }\n\n  function extend(a, b) {\n    for (const key in b) {\n      if (b.hasOwnProperty(key)) {\n        a[key] = b[key];\n      }\n    }\n    return a;\n  }\n\n  /**\n   * GridFx obj\n   */\n  class GridFx {\n    constructor(el, options) {\n      this.gridEl = el;\n      this.options = extend({}, this.options);\n      extend(this.options, options);\n\n      this.items = [].slice.call(this.gridEl.querySelectorAll('.grid__item'));\n      this.previewEl = nextSibling(this.gridEl);\n      this.isExpanded = false;\n      this.isAnimating = false;\n      this.closeCtrl = this.previewEl.querySelector('button.action--close');\n      this.previewDescriptionEl = this.previewEl.querySelector('.description--preview');\n\n      this._init();\n    }\n\n    _init() {\n      // callback\n      this.options.onInit(this);\n\n      const self = this;\n      // init masonry after all images are loaded\n      window.imagesLoaded(this.gridEl, () => {\n        // initialize masonry\n        // new Masonry(self.gridEl, {\n        //     itemSelector: '.grid__item',\n        //     isFitWidth: true\n        // });\n        // show grid after all images (thumbs) are loaded\n        self.gridEl.classList.add('grid--loaded');\n        // init/bind events\n        self._initEvents();\n        // create the large image and append it to the DOM\n        self._setOriginal();\n        // create the clone image and append it to the DOM\n        self._setClone();\n      });\n    }\n\n    /**\n     * initialize/bind events\n     */\n    _initEvents() {\n      const self = this;\n      const clickEvent = (document.ontouchstart !== null ? 'click' : 'touchstart');\n\n      this.items.forEach(item => {\n        const touchend = ev => {\n          ev.preventDefault();\n          self._openItem(ev, item);\n          item.removeEventListener('touchend', touchend);\n        };\n\n        const touchmove = ev => {\n          item.removeEventListener('touchend', touchend);\n        };\n\n        const manageTouch = () => {\n          item.addEventListener('touchend', touchend);\n          item.addEventListener('touchmove', touchmove);\n        };\n\n        item.addEventListener(clickEvent, ev => {\n          if (clickEvent === 'click') {\n            ev.preventDefault();\n            self._openItem(ev, item);\n          } else {\n            manageTouch();\n          }\n        });\n      });\n\n      // close expanded image\n      this.closeCtrl.addEventListener('click', () => {\n        self._closeItem();\n      });\n\n      window.addEventListener('resize', throttle(ev => {\n        // callback\n        self.options.onResize(self);\n      }, 10));\n    }\n\n    /**\n     * open a grid item\n     */\n    _openItem(ev, item) {\n      if (this.isAnimating || this.isExpanded) return;\n      this.isAnimating = true;\n      this.isExpanded = true;\n\n      // item's image\n      const gridImg = item.querySelector('img');\n\n      const gridImgOffset = gridImg.getBoundingClientRect();\n\n      // index of current item\n      this.current = this.items.indexOf(item);\n\n      // set the src of the original image element (large image)\n      this._setOriginal(item.querySelector('a').getAttribute('href'));\n\n      // callback\n      this.options.onOpenItem(this, item);\n\n      // set the clone image\n      this._setClone(gridImg.src, {\n        width: gridImg.offsetWidth,\n        height: gridImg.offsetHeight,\n        left: gridImgOffset.left,\n        top: gridImgOffset.top\n      });\n\n      // hide original grid item\n      item.classList.add('grid__item--current');\n\n      // calculate the transform value for the clone to animate to the full image view\n      const win = this._getWinSize();\n\n      const originalSizeArr = item.getAttribute('data-size').split('x');\n\n      const originalSize = {\n        width: originalSizeArr[0],\n        height: originalSizeArr[1],\n      };\n\n      const dx = ((this.options.imgPosition.x > 0 ? 1 - Math.abs(this.options.imgPosition.x) : Math.abs(this.options.imgPosition.x)) * win.width + this.options.imgPosition.x * win.width / 2) - gridImgOffset.left - 0.5 * gridImg.offsetWidth;\n      const dy = ((this.options.imgPosition.y > 0 ? 1 - Math.abs(this.options.imgPosition.y) : Math.abs(this.options.imgPosition.y)) * win.height + this.options.imgPosition.y * win.height / 2) - gridImgOffset.top - 0.5 * gridImg.offsetHeight;\n      const z = Math.min(Math.min(win.width * Math.abs(this.options.imgPosition.x) - this.options.pagemargin, originalSize.width - this.options.pagemargin) / gridImg.offsetWidth, Math.min(win.height * Math.abs(this.options.imgPosition.y) - this.options.pagemargin, originalSize.height - this.options.pagemargin) / gridImg.offsetHeight);\n\n      // apply transform to the clone\n      this.cloneImg.style.WebkitTransform = `translate3d(${dx}px, ${dy}px, 0) scale3d(${z}, ${z}, 1)`;\n      this.cloneImg.style.transform = `translate3d(${dx}px, ${dy}px, 0) scale3d(${z}, ${z}, 1)`;\n\n      // add the description if any\n      const descriptionEl = item.querySelector('.description');\n      if (descriptionEl) {\n        this.previewDescriptionEl.innerHTML = descriptionEl.innerHTML;\n      }\n\n      const self = this;\n      setTimeout(() => {\n        // controls the elements inside the expanded view\n        self.previewEl.classList.add('preview--open');\n        // callback\n        self.options.onExpand();\n      }, 0);\n\n      // after the clone animates..\n      onEndTransition(this.cloneImg, () => {\n        // when the original/large image is loaded..\n        window.imagesLoaded(self.originalImg, () => {\n          // close button just gets shown after the large image gets loaded\n          self.previewEl.classList.add('preview--image-loaded');\n          // animate the opacity to 1\n          self.originalImg.style.opacity = 1;\n          // and once that's done..\n          onEndTransition(self.originalImg, () => {\n            // reset cloneImg\n            self.cloneImg.style.opacity = 0;\n            self.cloneImg.style.WebkitTransform = 'translate3d(0,0,0) scale3d(1,1,1)';\n            self.cloneImg.style.transform = 'translate3d(0,0,0) scale3d(1,1,1)';\n\n            self.isAnimating = false;\n          });\n        });\n      });\n    }\n\n    /**\n     * create/set the original/large image element\n     */\n    _setOriginal(src) {\n      if (!src) {\n        this.originalImg = document.createElement('img');\n        this.originalImg.className = 'original';\n        this.originalImg.style.opacity = 0;\n        this.originalImg.style.maxWidth = `calc(${parseInt(Math.abs(this.options.imgPosition.x) * 100)}vw - ${this.options.pagemargin}px)`;\n        this.originalImg.style.maxHeight = `calc(${parseInt(Math.abs(this.options.imgPosition.y) * 100)}vh - ${this.options.pagemargin}px)`;\n        // need it because of firefox\n        this.originalImg.style.WebkitTransform = 'translate3d(0,0,0) scale3d(1,1,1)';\n        this.originalImg.style.transform = 'translate3d(0,0,0) scale3d(1,1,1)';\n        src = '';\n        this.previewEl.appendChild(this.originalImg);\n      }\n\n      this.originalImg.setAttribute('src', src);\n    }\n\n    /**\n     * create/set the clone image element\n     */\n    _setClone(src, settings) {\n      if (!src) {\n        this.cloneImg = document.createElement('img');\n        this.cloneImg.className = 'clone';\n        src = '';\n        this.cloneImg.style.opacity = 0;\n        this.previewEl.appendChild(this.cloneImg);\n      } else {\n        this.cloneImg.style.opacity = 1;\n        // set top/left/width/height of grid item's image to the clone\n        this.cloneImg.style.width = `${settings.width}px`;\n        this.cloneImg.style.height = `${settings.height}px`;\n        this.cloneImg.style.top = `${settings.top}px`;\n        this.cloneImg.style.left = `${settings.left}px`;\n      }\n\n      this.cloneImg.setAttribute('src', src);\n    }\n\n    /**\n     * closes the original/large image view\n     */\n    _closeItem() {\n      if (!this.isExpanded || this.isAnimating) return;\n      this.isExpanded = false;\n      this.isAnimating = true;\n\n      // the grid item's image and its offset\n      const gridItem = this.items[this.current];\n\n      const gridImg = gridItem.querySelector('img');\n      const gridImgOffset = gridImg.getBoundingClientRect();\n      const self = this;\n\n      this.previewEl.classList.remove('preview--open');\n      this.previewEl.classList.remove('preview--image-loaded');\n\n      // callback\n      this.options.onCloseItem(this, gridItem);\n\n      // large image will animate back to the position of its grid's item\n      this.originalImg.classList.add('animate');\n\n      // set the transform to the original/large image\n      const win = this._getWinSize();\n\n      const dx = gridImgOffset.left + gridImg.offsetWidth / 2 - ((this.options.imgPosition.x > 0 ? 1 - Math.abs(this.options.imgPosition.x) : Math.abs(this.options.imgPosition.x)) * win.width + this.options.imgPosition.x * win.width / 2);\n      const dy = gridImgOffset.top + gridImg.offsetHeight / 2 - ((this.options.imgPosition.y > 0 ? 1 - Math.abs(this.options.imgPosition.y) : Math.abs(this.options.imgPosition.y)) * win.height + this.options.imgPosition.y * win.height / 2);\n      const z = gridImg.offsetWidth / this.originalImg.offsetWidth;\n\n      this.originalImg.style.WebkitTransform = `translate3d(${dx}px, ${dy}px, 0) scale3d(${z}, ${z}, 1)`;\n      this.originalImg.style.transform = `translate3d(${dx}px, ${dy}px, 0) scale3d(${z}, ${z}, 1)`;\n\n      // once that's done..\n      onEndTransition(this.originalImg, () => {\n        // clear description\n        self.previewDescriptionEl.innerHTML = '';\n\n        // show original grid item\n        gridItem.classList.remove('grid__item--current');\n\n        // fade out the original image\n        setTimeout(() => {\n          self.originalImg.style.opacity = 0;\n        }, 60);\n\n        // and after that\n        onEndTransition(self.originalImg, () => {\n          // reset original/large image\n          self.originalImg.classList.remove('animate');\n          self.originalImg.style.WebkitTransform = 'translate3d(0,0,0) scale3d(1,1,1)';\n          self.originalImg.style.transform = 'translate3d(0,0,0) scale3d(1,1,1)';\n\n          self.isAnimating = false;\n        });\n      });\n    }\n\n    /**\n     * gets the window sizes\n     */\n    _getWinSize() {\n      return {\n        width: document.documentElement.clientWidth,\n        height: window.innerHeight,\n      };\n    }\n  }\n\n  /**\n   * options\n   */\n  GridFx.prototype.options = {\n    pagemargin: 0,\n    // x and y can have values from 0 to 1 (percentage). If negative then\n    // it means the alignment is left and/or top rather than right and/or bottom\n    // so, as an example, if we want our large image to be positioned vertically on 25%\n    // of the screen and centered horizontally the values would be x:1,y:-0.25\n    imgPosition: {\n      x: 1,\n      y: 1,\n    },\n    onInit(instance) {\n      return false;\n    },\n    onResize(instance) {\n      return false;\n    },\n    onOpenItem(instance, item) {\n      return false;\n    },\n    onCloseItem(instance, item) {\n      return false;\n    },\n    onExpand() {\n      return false;\n    },\n  };\n\n  window.GridFx = GridFx;\n}\n"]}